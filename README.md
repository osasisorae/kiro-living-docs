# Auto-Doc-Sync (Kiro Living Docs)

Auto-Doc-Sync is a small TypeScript CLI that scans your code changes and keeps Kiro project docs in sync. It can:

- Update `.kiro/specs/api.md` with generated API documentation
- Maintain a single `## Features & API` section in your `README.md` (deduplicated)
- Write development logs into `.kiro/development-log/` for traceability

This repo contains the tool itself plus tests.

## Quickstart (run this tool)

```bash
git clone git@github.com:osasisorae/kiro-living-docs.git
cd kiro-living-docs
npm install
npm test
npm run build
```

## Use on your own project

You can run Auto-Doc-Sync against any workspace directory:

```bash
node dist/cli.js --workspace=/absolute/path/to/your/project --trigger=manual
```

If you run it from inside your project, you can omit `--workspace`:

```bash
auto-doc-sync --trigger=manual
```

The CLI supports targeting specific files:

```bash
auto-doc-sync --trigger=manual --file=src/api.ts --file=src/types.ts
```

Run `auto-doc-sync --help` for the full list of options.

## Configuration

Auto-Doc-Sync loads configuration in this order:

1. `--config=PATH` (if provided)
2. `.kiro/auto-doc-sync.json` (in the workspace)
3. Built-in defaults

Example `.kiro/auto-doc-sync.json`:

```jsonc
{
  // Optional: set a workspace root when running from another directory
  "workspaceRoot": ".",
  "analysis": {
    "includePatterns": ["**/*.ts", "**/*.js"],
    "excludePatterns": ["**/node_modules/**", "**/dist/**"],
    "maxFileSize": 1048576,
    "analysisDepth": "shallow"
  },
  "output": {
    "preserveFormatting": true,
    "backupFiles": true,
    "validateOutput": true
  },
  "logging": {
    "logDirectory": ".kiro/development-log",
    "maxEntriesPerFile": 100,
    "retentionDays": 30,
    "groupingTimeWindow": 5
  },
  "subagent": {
    "enabled": false,
    "configPath": ".kiro/subagents/doc-analysis-agent.json"
  },
  "hooks": {
    "enabled": false,
    "configPath": ".kiro/hooks"
  }
}
```

Notes:

- Relative paths in config (like `logDirectory` or `hooks.configPath`) resolve relative to the workspace root.
- You can also override the workspace root at runtime using `--workspace=PATH`.

## Generated files

When it runs, Auto-Doc-Sync writes to/updates:

- `.kiro/specs/api.md` (generated API documentation)
- `.kiro/development-log/*.md` (development logs)
- `README.md` (only the `## Features & API` section)

## Git hook usage

To run it as part of a git hook (or a Kiro hook), call:

```bash
auto-doc-sync --trigger=git-hook
```

## Project structure (tool source)

```
src/
├── analysis/        # Code analysis and change detection
├── hooks/           # Hook integration
├── logging/         # Development log writer
├── output/          # Atomic writes + section updates
├── templates/       # Documentation templates
├── types/           # Core TypeScript types
└── cli.ts           # CLI entrypoint
```

## Contributing

```bash
npm test
npm run build
```

## Features & API

This section is auto-generated by Auto-Doc-Sync. Run `auto-doc-sync` to update it.
